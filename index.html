<!doctype html>
<html lang="en"> 
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Pak Sim Details</title>

  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: "Poppins", Arial, sans-serif;
      background: linear-gradient(135deg, #0f0c29, #302b63, #24243e);
      min-height: 100vh;
      display: flex; justify-content: center; align-items: center;
      color: #fff; overflow-x: hidden;
    }

    #matrixCanvas {
      position: fixed; top: 0; left: 0;
      width: 100vw; height: 100vh;
      z-index: 0; opacity: 0.15; pointer-events: none;
    }

    .box {
      position: relative; z-index: 1;
      background: rgba(255,255,255,0.08);
      border-radius: 20px;
      padding: 40px 30px;
      width: 100%; max-width: 450px;
      border: 1px solid rgba(255,255,255,0.25);
      text-align: center;
    }

    .box h2 {
      font-size: 30px; margin-bottom: 25px;
      background: linear-gradient(90deg, #ff00cc, #3333ff);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    .box input {
      width: 100%; padding: 14px; margin-bottom: 20px;
      border-radius: 12px; border: none;
      background: rgba(255,255,255,0.12); color: #fff;
    }

    .box button {
      width: 100%; padding: 14px; margin: 10px 0;
      border: none; border-radius: 12px;
      font-size: 16px; font-weight: bold;
      cursor: pointer; color: #fff;
    }

    .primary-btn { background: linear-gradient(90deg, #ff416c, #ff4b2b); }
    .whatsapp-btn { background: linear-gradient(90deg, #25D366, #128C7E); }
    .telegram-btn { background: linear-gradient(90deg, #00c6ff, #0072ff); }
    .copy-btn { background: linear-gradient(90deg, #555, #333); }

    #responseBox {
      display: none; background: rgba(0,0,0,0.35);
      padding: 18px; margin-top: 20px;
      border-radius: 12px; font-size: 15px;
      max-height: 320px; overflow-y: auto;
      white-space: pre-line;
    }

  </style>
</head>

<script type="module" src="protect.js"></script>

<!-- FIREBASE LOGIN PROTECTION -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-app.js";
import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-auth.js";

const firebaseConfig = {
  apiKey: "AIzaSyCfLFgbq7m-pEK-jw-PQvwGh4zlyGE8n4w",
  authDomain: "nasir-48572.firebaseapp.com",
  databaseURL: "https://nasir-48572-default-rtdb.firebaseio.com",
  projectId: "nasir-48572",
  storageBucket: "nasir-48572.appspot.com",
  messagingSenderId: "1032758456576",
  appId: "1:1032758456576:web:eaea202eb1f313efc743e5"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);

onAuthStateChanged(auth, user => {
  if (!user) window.location.href = "/login.html";
});
</script>

<body>

<canvas id="matrixCanvas"></canvas>

<div class="box">
  <h2>NASIR HACKER DB</h2>

  <button onclick="logout()" style="background:red;color:white;padding:8px;border:none;border-radius:6px;">Logout</button>

  <input type="text" id="number" placeholder="Enter phone number or CNIC" required>
  <button class="primary-btn" onclick="fetchData()">üîé Get Details</button>

  <div id="responseBox"></div>

  <button id="shareButton" class="whatsapp-btn" onclick="shareWhatsApp()" style="display:none;">üì≤ Share on WhatsApp</button>
  <button id="copyButton" class="copy-btn" onclick="copyToClipboard()" style="display:none;">üìã Copy Data</button>

  <button class="telegram-btn" onclick="window.open('https://api.whatsapp.com/send?phone=+923206939553')">üí¨ Owner Contact</button>
</div>


<script>
/* ---------------------------
   üî• FIXED WORKING API SYSTEM
----------------------------*/

async function fetchData() {
  const number = document.getElementById("number").value.trim();
  const box = document.getElementById("responseBox");
  const shareBtn = document.getElementById("shareButton");
  const copyBtn = document.getElementById("copyButton");

  if (!number) return alert("Please enter a number or CNIC.");

  box.style.display = "block";
  box.innerHTML = "<p style='color:#FFD700;font-weight:bold;'>‚è≥ Fetching‚Ä¶</p>";
  shareBtn.style.display = "none";
  copyBtn.style.display = "none";

  const realAPI = `https://legendxdata.site/Api/simdata.php?phone=${number}`;

  // WORKING PROXY FIX
  const proxy = `https://api.allorigins.win/raw?url=${encodeURIComponent(realAPI)}`;

  try {
    let res = await fetch(proxy);

    if (!res.ok) throw new Error("Proxy failed");

    const data = await res.json();

    if (!data.success || !Array.isArray(data.records)) {
      box.innerHTML = "<b style='color:#FFD700;'>‚ùå No record found.</b>";
      return;
    }

    let txt = "";
    data.records.forEach((r, i) => {
      txt += `Result ${i + 1}:\n`;
      txt += `üìû Mobile: ${r.Mobile || "Not found"}\n`;
      txt += `üë§ Name: ${r.Name || "Not found"}\n`;
      txt += `üÜî CNIC: ${r.CNIC || "Not found"}\n`;
      txt += `üìç Address: ${r.Address || "Not found"}\n`;
      txt += `üåç Country: ${r.Country || "Not found"}\n\n`;
    });

    box.innerText = txt.trim();
    shareBtn.style.display = "inline-block";
    copyBtn.style.display = "inline-block";

  } catch (err) {
    box.innerHTML = `<p style="color:red;font-weight:bold;">‚ùå Error fetching API</p>`;
  }
}

/* ----------------------------------------------------- */

function shareWhatsApp() {
  const txt = document.getElementById("responseBox").innerText;
  window.open(`https://api.whatsapp.com/send?text=${encodeURIComponent(txt)}`);
}

function copyToClipboard() {
  const text = document.getElementById("responseBox").innerText;
  navigator.clipboard.writeText(text);
  alert("Copied!");
}

</script>


<script>
// MATRIX EFFECT (untouched)
const canvas = document.getElementById("matrixCanvas");
const ctx = canvas.getContext("2d");
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

const letters = "01";
const fontSize = 16;
let columns = Math.floor(canvas.width / fontSize);
let drops = Array(columns).fill(1);

function drawMatrix() {
  ctx.fillStyle = "rgba(0,0,0,0.05)";
  ctx.fillRect(0,0,canvas.width,canvas.height);

  ctx.fillStyle = "#00ff99";
  ctx.font = fontSize + "px monospace";

  drops.forEach((y, i) => {
    const text = letters[Math.floor(Math.random()*letters.length)];
    ctx.fillText(text, i*fontSize, y*fontSize);

    if (y*fontSize > canvas.height && Math.random() > 0.975)
      drops[i] = 0;

    drops[i]++;
  });
}
setInterval(drawMatrix, 35);
</script>

</body>
</html>
